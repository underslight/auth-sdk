!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("axios")):"function"==typeof define&&define.amd?define(["exports","axios"],e):e((t||self).auth={},t.axios)}(this,function(t,e){function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r,i=/*#__PURE__*/n(e);t.ApiErrorCode=void 0,(r=t.ApiErrorCode||(t.ApiErrorCode={})).UserNotFound="USER_NOT_FOUND",r.UserDisabled="USER_DISABLED",r.HashFailed="HASH_FAILED",r.CredentialDuplicate="CREDENTIAL_DUPLICATE",r.CredentialOnly="CREDENTIAL_ONLY",r.CredentialNotFound="CREDENTIAL_NOT_FOUND",r.MfaRequired="MFA_REQUIRED",r.Io="IO",r.SaveFailed="SAVE_FAILED",r.UpdateFailed="UPDATE_FAILED",r.TokenExpired="TOKEN_EXPIRED",r.TokenInvalid="TOKEN_INVALID",r.DatabaseFailed="DATABASE_OP_FAILED",r.Unknown="UNKNOWN";var o=function(t){this.client=void 0,this.client=i.default.create({withCredentials:!0,baseURL:t.domain})},u=/*#__PURE__*/function(){function t(t){var e=t.id,n=t.attributes,r=t.metadata;this.id=void 0,this.attributes=void 0,this.metadata=void 0,this.id=e,this.attributes=n,this.metadata=r}var e=t.prototype;return e.linkAuthMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.link(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.unlinkAuthMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.unlink(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.linkMfaMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.link(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.unlinkMfaMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.unlink(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.delete=function(t){return new Promise(function(e,n){try{return Promise.resolve(t.client.client.delete("/delete").then(function(t){return e()}).catch(function(t){return n(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.update=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.client.put("/update",e.attributes).then(function(t){return n(e)}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},t}(),c=/*#__PURE__*/function(){function t(t){this.config=void 0,this.client=void 0,this.config=t,this.client=new o(this.config)}var e=t.prototype;return e.currentUser=function(t){var e=this;return new Promise(function(n,r){try{return t&&e.client.client.get("/current").then(function(t){return n(new u(t.data.user))}).catch(function(t){return r(t.response.data)}),Promise.resolve()}catch(t){return Promise.reject(t)}})},e.authenticate=function(t){return t.authenticate(this.client)},e.register=function(t){return t.register(this.client)},t}();t.AuthMethodType=void 0,(t.AuthMethodType||(t.AuthMethodType={})).EmailPassword="EmailPassword",t.MfaMethodType=void 0,(t.MfaMethodType||(t.MfaMethodType={})).Totp="Totp";var a=/*#__PURE__*/function(){function e(e,n,r){this.type=t.AuthMethodType.EmailPassword,this.mfa_code=void 0,this.email=void 0,this.password=void 0,this.email=e,this.password=n,this.mfa_code=r}var n=e.prototype;return n.setMfaCode=function(t){this.mfa_code=t},n.authenticate=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(t.client.post("/authenticate/"+n.type,{email:n.email,password:n.password,mfa_code:n.mfa_code}).then(function(t){var n=t.data;e&&"undefined"!=typeof window&&(window.location.href=e),r(new u(n.user))}).catch(function(t){return i(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},n.register=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(t.client.post("/register/"+n.type,{email:n.email,password:n.password}).then(function(t){var n=t.data;e&&"undefined"!=typeof window&&(window.location.href=e),r(new u(n.user))}).catch(function(t){return i(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},n.link=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.post("/link/"+e.type,{email:e.email,password:e.password}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},n.unlink=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.delete("/unlink/auth",{data:{auth_method:e.type}}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e}(),s=/*#__PURE__*/function(){function e(){this.type=t.MfaMethodType.Totp}var n=e.prototype;return n.link=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.post("/link/mfa",{mfa_method:e.type}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},n.unlink=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.delete("/unlink/mfa",{data:{mfa_method:e.type}}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e}();t.EmailPasswordMethod=a,t.TotpMethod=s,t.UnderslightAuth=c,t.User=u});
