import t from"axios";var e;!function(t){t.UserNotFound="USER_NOT_FOUND",t.UserDisabled="USER_DISABLED",t.HashFailed="HASH_FAILED",t.CredentialDuplicate="CREDENTIAL_DUPLICATE",t.CredentialOnly="CREDENTIAL_ONLY",t.CredentialNotFound="CREDENTIAL_NOT_FOUND",t.MfaRequired="MFA_REQUIRED",t.Io="IO",t.SaveFailed="SAVE_FAILED",t.UpdateFailed="UPDATE_FAILED",t.TokenExpired="TOKEN_EXPIRED",t.TokenInvalid="TOKEN_INVALID",t.DatabaseFailed="DATABASE_OP_FAILED",t.Unknown="UNKNOWN"}(e||(e={}));var n,r,i=function(e){this.client=void 0,this.client=t.create({withCredentials:!0,baseURL:e.domain})},o=/*#__PURE__*/function(){function t(t){var e=t.id,n=t.attributes,r=t.metadata;this.id=void 0,this.attributes=void 0,this.metadata=void 0,this.id=e,this.attributes=n,this.metadata=r}var e=t.prototype;return e.linkAuthMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.link(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.unlinkAuthMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.unlink(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.linkMfaMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.link(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.unlinkMfaMethod=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(e.unlink(t.client).then(function(t){return r(n)}).catch(function(t){return i(t)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.delete=function(t){return new Promise(function(e,n){try{return Promise.resolve(t.client.client.delete("/delete").then(function(t){return e()}).catch(function(t){return n(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.update=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.client.put("/update",e.attributes).then(function(t){return n(e)}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},t}(),c=/*#__PURE__*/function(){function t(t){this.config=void 0,this.client=void 0,this.config=t,this.client=new i(this.config)}var e=t.prototype;return e.currentUser=function(t){var e=this;return new Promise(function(n,r){try{return t&&e.client.client.get("/current").then(function(t){return n(new o(t.data.user))}).catch(function(t){return r(t.response.data)}),Promise.resolve()}catch(t){return Promise.reject(t)}})},e.authenticate=function(t){return t.authenticate(this.client)},e.register=function(t){return t.register(this.client)},t}();!function(t){t.EmailPassword="EmailPassword"}(n||(n={})),function(t){t.Totp="Totp"}(r||(r={}));var u=/*#__PURE__*/function(){function t(t,e,r){this.type=n.EmailPassword,this.mfa_code=void 0,this.email=void 0,this.password=void 0,this.email=t,this.password=e,this.mfa_code=r}var e=t.prototype;return e.setMfaCode=function(t){this.mfa_code=t},e.authenticate=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(t.client.post("/authenticate/"+n.type,{email:n.email,password:n.password,mfa_code:n.mfa_code}).then(function(t){var n=t.data;e&&"undefined"!=typeof window&&(window.location.href=e),r(new o(n.user))}).catch(function(t){return i(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.register=function(t,e){var n=this;return new Promise(function(r,i){try{return Promise.resolve(t.client.post("/register/"+n.type,{email:n.email,password:n.password}).then(function(t){var n=t.data;e&&"undefined"!=typeof window&&(window.location.href=e),r(new o(n.user))}).catch(function(t){return i(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.link=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.post("/link/"+e.type,{email:e.email,password:e.password}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.unlink=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.delete("/unlink/auth",{data:{auth_method:e.type}}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},t}(),a=/*#__PURE__*/function(){function t(){this.type=r.Totp}var e=t.prototype;return e.link=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.post("/link/mfa",{mfa_method:e.type}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},e.unlink=function(t){var e=this;return new Promise(function(n,r){try{return Promise.resolve(t.client.delete("/unlink/mfa",{data:{mfa_method:e.type}}).then(function(t){return n()}).catch(function(t){return r(t.response.data)})).then(function(){})}catch(t){return Promise.reject(t)}})},t}();export{e as ApiErrorCode,n as AuthMethodType,u as EmailPasswordMethod,r as MfaMethodType,a as TotpMethod,c as UnderslightAuth,o as User};
